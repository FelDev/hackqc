(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{386:function(t,e,a){"use strict";a.r(e);a(12);var n=a(2),r=a(387),i=a.n(r),s=a(104),o={name:"GoogleMap",components:{GmapCluster:i.a},computed:{google:s.gmapApi},props:{minDate:null,maxDate:null,donnee:{type:Array,default:function(){return{}}}},data:function(){return{center:{lat:45.508,lng:-73.587},markers:[],places:[],currentPlace:null}},mounted:function(){var t=this;this.geolocate(),this.$watch(function(){return t.google?{data:t.donnee,minDate:t.minDate,maxDate:t.maxDate}:[]},function(e){var a=e.data;if(!Object(n.isEmpty)(a)){var r=!1,i=new t.google.maps.LatLngBounds;t.markers=a.filter(function(e){return e.date>=new Date(t.minDate)&&e.date<=new Date(t.maxDate)}),t.markers.forEach(function(e){r=!0,i.extend(new t.google.maps.LatLng(e.position.lat,e.position.lng))}),r&&t.$refs.mapRef.$mapPromise.then(function(t){t.fitBounds(i)})}},{immediate:!0})},methods:{selectMarker:function(t){console.log(t)},setPlace:function(t){this.currentPlace=t},addMarker:function(){if(this.currentPlace){var t={lat:this.currentPlace.geometry.location.lat(),lng:this.currentPlace.geometry.location.lng()};this.markers.push({position:t}),this.places.push(this.currentPlace),this.center=t,this.currentPlace=null}},geolocate:function(){var t=this;navigator.geolocation.getCurrentPosition(function(e){t.center={lat:e.coords.latitude,lng:e.coords.longitude}})}}},c=a(3),u=Object(c.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("gmap-map",{ref:"mapRef",staticStyle:{width:"100%",height:"400px"},attrs:{center:t.center,zoom:12}},[a("gmap-cluster",t._l(t.markers,function(e,n){return a("gmap-marker",{key:n,attrs:{position:e.position},on:{click:function(a){return t.selectMarker(e)}}})}),1)],1)],1)},[],!1,null,null,null);e.default=u.exports},391:function(t,e,a){"use strict";a.r(e);a(12),a(13),a(19);var n=a(269),r=a(386),i=(a(286),a(2)),s=(a(32),a(1)),o=a.n(s),c=a(11),u=a(389),l=a(6),d=a(390),f=a.n(d);function h(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}c.a.use(u.a);window.moment=o.a;var p={name:"Chart",props:{minDate:null,maxDate:null,display:!1,donnee:{type:Array,default:function(){return{}}}},data:function(){return{SECOND_TO_DAYS:86400,SECOND_TO_WEEK:604800,SECOND_TO_MONTH:2592e3,SECOND_TO_YEAR:31536e3,cursorWrapperWidth:0,timeRange:604800,datas:[],selectedDate:null,chartData:[],chartDates:[],chartOptions:{},selectedRange:{from:null,to:null},draggable:null,tl:null}},computed:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),n.forEach(function(e){h(t,e,a[e])})}return t}({},Object(l.b)({viewport:"Interface/viewport"}),{cursorWidth:function(){return this.cursorWrapperWidth/(this.dateRangeMs/this.timeRange)},firstDate:function(){return Object(i.min)(this.chartDates)},lastDate:function(){return Object(i.max)(this.chartDates)},axis:function(){Object(i.isEmpty)(this.chartData);if(Object(i.isEmpty)(this.chartData))return{x:[],y:[]};var t=[o.a.unix(this.firstDate.toString()),o.a.unix(this.firstDate.toString()).add(this.convertPercentToMs(.25,"s")),o.a.unix(this.firstDate.toString()).add(this.convertPercentToMs(.5,"s")),o.a.unix(this.firstDate.toString()).add(this.convertPercentToMs(.75,"s")),o.a.unix(this.lastDate.toString())];return{x:Object(i.map)(t,function(t){return t.format("DD/MM/YY")}),y:[Object(i.max)(this.chartData),Object(i.min)(this.chartData)]}},dateRangeMs:function(){return this.chartDates.length<2?0:Object(i.last)(this.chartDates)-Object(i.first)(this.chartDates)}}),mounted:function(){var t=this,e={x:0},a=Object(i.throttle)(function(){t.onUpdateRangeDate(e.x)},10);this.tl=new TimelineMax({paused:!0}).to(e,10,{x:this.viewport.width-60},0).to(this.$refs.Cursor,10,{x:this.viewport.width-60,onUpdate:a},0),this.$watch("viewport",function(e){var a=e.width;a&&(t.cursorWrapperWidth=a-40)},{immediate:!0}),this.$watch("chartDates",function(e){Object(i.isEmpty)(e)||t.$nextTick(t.createDraggable.bind(t))},{immediate:!0});var n=this.$watch("display",function(e){e&&(t.tl.play(0),t.$nextTick(n.bind(t)))});this.$watch(function(){return t.donnee},function(e){if(Object(i.isEmpty)(e))return[];t.chartData=[],t.chartDates=[],t.chartOptions={};var a=[],n=0;e.forEach(function(t){if(!isNaN(t.amount)){var e=new Date(t.date);e.setHours(0,0,0,0);var r=o()(e).format("X");a[r]?a[r]+=t.amount:(a[r]=t.amount,n++),t.amount}});for(var r in a)a.hasOwnProperty(r)&&(t.chartData.push(a[r]),t.chartDates.push(r),0);t.chartOptions={curveType:"function"}},{immediate:!0})},methods:{formatUnixDate:function(t){return o.a.unix(t).format("DD/MM/YYYY")},convertPercentToMs:function(t){return t*this.dateRangeMs*1e3},onUpdateRangeDate:function(t){var e=this;console.log("x",t,this.draggable);var a,n=(a=t/e.cursorWrapperWidth)>1?1:a<0?0:a,r=this.convertPercentToMs(n);this.selectedRange={from:o.a.unix(this.firstDate.toString()).add(r,"ms").format("DD/MM/YY"),to:o.a.unix(this.firstDate.toString()).add(r,"ms").add(this.timeRange,"s").format("DD/MM/YY")}},createDraggable:function(){var t=this;this.draggable=f.a.create(this.$refs.Cursor,{type:"x",edgeResistance:.65,bounds:this.$refs.CursorWrapper,lockAxis:!0,throwProps:!0,snap:{x:function(t){return Math.round(t/gridWidth)*gridWidth},y:function(t){return Math.round(t/gridHeight)*gridHeight}},onDrag:function(){t.onUpdateRangeDate(t.draggable[0].x)},onDragInit:function(){t.onUpdateRangeDate(t.draggable[0].x)},onDragEnd:function(){t.onUpdateRangeDate(t.draggable[0].x)}}),this.$nextTick(function(){t.onUpdateRangeDate(t.draggable[0].x)})}}},g=(a(416),a(3)),m=Object(g.a)(p,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"component"},[a("header",{staticClass:"header"},[a("h3",{staticClass:"title"},[t._v("Tendances")]),t._v(" "),a("p",{staticClass:"dates",domProps:{textContent:t._s("du "+t.selectedRange.from+" au "+t.selectedRange.to)}})]),t._v(" "),a("div",{staticClass:"TheChart"},[a("ul",{staticClass:"axis -y"},t._l(t.axis.y,function(e,n){return a("li",{key:"y-"+n,staticClass:"data",domProps:{textContent:t._s(e)}})}),0),t._v(" "),a("ul",{staticClass:"axis -x"},t._l(t.axis.x,function(e,n){return a("li",{key:"x-"+n,staticClass:"data",domProps:{textContent:t._s(e)}})}),0),t._v(" "),a("pre",[t._v(t._s(t.display))]),t._v(" "),t.display?a("trend",{ref:"Trend",staticClass:"chart",attrs:{data:t.chartData,gradient:["#6fa8dc","#42b983","#2c3e50"],"auto-draw":"",smooth:""}}):t._e(),t._v(" "),a("div",{ref:"CursorWrapper",staticClass:"cursorWrapper"},[a("div",{ref:"Cursor",staticClass:"cursor",style:{width:t.cursorWidth+"px"}})])],1),t._v(" "),a("div",{staticClass:"ranges"},[a("button",{staticClass:"range -day",on:{click:function(e){e.preventDefault(),t.timeRange=t.SECOND_TO_DAYS}}},[t._v("Days")]),t._v(" "),a("button",{staticClass:"range -week",on:{click:function(e){e.preventDefault(),t.timeRange=t.SECOND_TO_WEEK}}},[t._v("Semaines")]),t._v(" "),a("button",{staticClass:"range -month",on:{click:function(e){e.preventDefault(),t.timeRange=t.SECOND_TO_MONTH}}},[t._v("Mois")]),t._v(" "),a("button",{staticClass:"range -year",on:{click:function(e){e.preventDefault(),t.timeRange=t.SECOND_TO_YEAR}}},[t._v("AnnÃ©e")]),t._v(" "),a("button",{staticClass:"range -year",on:{click:function(e){return e.preventDefault(),t.tl.play(0)}}},[t._v("Play")]),t._v(" "),a("button",{staticClass:"range -year",on:{click:function(e){return e.preventDefault(),t.tl.pause()}}},[t._v("Pause")])])])},[],!1,null,"eae5a20a",null).exports,D=a(25);function v(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var b={name:"PageInfoSingle",components:{UiPicture:n.a,GoogleMap:r.default,Chart:m},computed:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),n.forEach(function(e){v(t,e,a[e])})}return t}({},Object(l.b)({data:"Informations/data",page:"Informations/page"}),{slug:function(){return this.$route.params.slug}}),data:function(){return{isOnViewport:!1,renderMap:!1,dateRange:[],minDateB:"2018-01-12T00:00:00-05:00",maxDateB:"2018-08-12T00:00:00-04:00",minDate:"2018-01-12T10:41:26",maxDate:"2019-08-12T10:41:26"}},watch:{slug:{handler:function(t){this.$store.dispatch("Informations/LOAD",t)},immediate:!0}},mounted:function(){var t=this;this.$refs.Chart.$watch("selectedRange",function(e){t.dateRange=Object(i.map)(e,function(t){return o()(t,"DD/MM/YY").format("YYYY-MM-DDTh:mm:ss")})}),this.initScrollMagic()},methods:{initScrollMagic:function(){var t=this,e=new D.Scene({triggerElement:this.$refs.ChartWrapper,triggerHook:1}).addIndicators().on("enter",function(){t.isOnViewport=!0}).on("leave",function(){t.isOnViewport=!1});this.$store.dispatch("ScrollMagic/ADD_SCENE",{scene:e,indicators:!1})}}},_=(a(417),a(418)),O=a.n(_),x=a(419),y=Object(g.a)(b,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("main",{staticClass:"PageInfoSingle"},[a("section",{attrs:{id:"top"}},[a("header",{staticClass:"header"},[a("UiPicture",{staticClass:"picture",attrs:{src:t.page.image,cover:"cover",full:!0,overlay:!0}}),t._v(" "),a("h1",{staticClass:"title",domProps:{textContent:t._s(t.page.title)}})],1),t._v(" "),a("div",{staticClass:"content",domProps:{innerHTML:t._s(t.page.description)}})]),t._v(" "),a("section",{attrs:{id:"bottom-no-bg"}},[t.dateRange?a("GoogleMap",{attrs:{minDate:t.dateRange[0],maxDate:t.dateRange[1],donnee:t.data}}):t._e(),t._v(" "),a("div",{ref:"ChartWrapper"},[a("Chart",{ref:"Chart",attrs:{display:t.isOnViewport,minDate:t.minDate,maxDate:t.maxDate,donnee:t.data}})],1)],1),t._v(" "),a("a",{staticClass:"button",attrs:{href:t.page.contact}},[t._v("Ressources en cas d'infestation")])])},[],!1,null,"2e80264b",null);"function"==typeof O.a&&O()(y),"function"==typeof x.default&&Object(x.default)(y);e.default=y.exports},403:function(t,e,a){},404:function(t,e,a){},405:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"fr":{"statsTitle":"Statistiques","mapTitle":"PrÃ¨s de chez vous"}}'),delete t.options._Ctor}},416:function(t,e,a){"use strict";var n=a(403);a.n(n).a},417:function(t,e,a){"use strict";var n=a(404);a.n(n).a},418:function(t,e){},419:function(t,e,a){"use strict";var n=a(405),r=a.n(n);e.default=r.a}}]);