(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{386:function(t,e,a){"use strict";a.r(e);a(12);var n=a(2),r=a(387),i=a.n(r),s=a(105),o={name:"GoogleMap",components:{GmapCluster:i.a},computed:{google:s.gmapApi},props:{minDate:null,maxDate:null,donnee:{type:Array,default:function(){return{}}}},data:function(){return{center:{lat:45.508,lng:-73.587},markers:[],places:[],currentPlace:null}},mounted:function(){var t=this;this.geolocate(),this.$watch(function(){return t.google?t.donnee:[]},function(e){if(!Object(n.isEmpty)(e)){var a=new t.google.maps.LatLngBounds;t.markers=e.filter(function(e){return e.date>=new Date(t.minDate)&&e.date<=new Date(t.maxDate)}),t.markers.forEach(function(e){a.extend(new t.google.maps.LatLng(e.position.lat,e.position.lng))}),t.$refs.mapRef.$mapPromise.then(function(t){t.fitBounds(a)})}},{immediate:!0})},methods:{selectMarker:function(t){console.log(t)},setPlace:function(t){this.currentPlace=t},addMarker:function(){if(this.currentPlace){var t={lat:this.currentPlace.geometry.location.lat(),lng:this.currentPlace.geometry.location.lng()};this.markers.push({position:t}),this.places.push(this.currentPlace),this.center=t,this.currentPlace=null}},geolocate:function(){var t=this;navigator.geolocation.getCurrentPosition(function(e){t.center={lat:e.coords.latitude,lng:e.coords.longitude}})}}},c=a(3),u=Object(c.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("gmap-map",{ref:"mapRef",staticStyle:{width:"100%",height:"400px"},attrs:{center:t.center,zoom:12}},[a("gmap-cluster",t._l(t.markers,function(e,n){return a("gmap-marker",{key:n,attrs:{position:e.position},on:{click:function(a){return t.selectMarker(e)}}})}),1)],1)],1)},[],!1,null,null,null);e.default=u.exports},391:function(t,e,a){"use strict";a.r(e);a(12),a(13),a(19);var n=a(270),r=a(386),i=a(2),s=a(1),o=a.n(s),c=a(11),u=a(389),l=a(6),f=a(390),h=a.n(f);function p(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}c.a.use(u.a);var d={name:"Chart",props:{minDate:null,maxDate:null,donnee:{type:Array,default:function(){return{}}}},data:function(){return{SECOND_TO_DAYS:86400,SECOND_TO_WEEK:604800,SECOND_TO_MONTH:2592e3,SECOND_TO_YEAR:31536e3,cursorWrapperWidth:0,timeRange:604800,datas:[],selectedDate:null,chartData:[],chartDates:[],chartOptions:{}}},computed:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),n.forEach(function(e){p(t,e,a[e])})}return t}({},Object(l.b)({viewport:"Interface/viewport"}),{cursorWidth:function(){var t=this.cursorWrapperWidth/(this.dateDiffRange/this.timeRange);return console.log(this.cursorWrapperWidth,this.dateDiffRange,this.timeRange,this.dateDiffRange/this.timeRange,t),t},axis:function(){Object(i.isEmpty)(this.chartData);if(Object(i.isEmpty)(this.chartData))return{x:[],y:[]};var t=[Object(i.first)(this.chartDates)],e=Math.round((this.chartDates.length-1)/2);return t.push(this.chartDates[e]),t.push(this.chartDates[Math.round(e/2)]),t.push(this.chartDates[Math.round(e+e/2)]),t.push(Object(i.last)(this.chartDates)),{x:Object(i.map)(t,function(t){return o.a.unix(t).format("DD/MM/YY")}),y:[Object(i.max)(this.chartData),Object(i.min)(this.chartData)]}},dateDiffRange:function(){if(Object(i.isEmpty)(this.chartDates))return 0;var t=Object(i.first)(this.chartDates),e=Object(i.last)(this.chartDates);return console.log({min:t,max:e,d:this.chartDates}),e-t}}),mounted:function(){var t=this;this.$watch("viewport",function(e){var a=e.width;a&&(console.log({width:a}),t.cursorWrapperWidth=a-40)},{immediate:!0});var e=h.a.create(this.$refs.Cursor,{type:"x",edgeResistance:.65,bounds:this.$refs.CursorWrapper,lockAxis:!0,throwProps:!0,snap:{x:function(t){return Math.round(t/gridWidth)*gridWidth},y:function(t){return Math.round(t/gridHeight)*gridHeight}},onDrag:function(a){var n=e[0].x;n>t.cursorWrapperWidth?n=t.cursorWrapperWidth:n<0&&(n=0);var r=t.dateDiffRange/t.timeRange;console.log({x:n,cursorWrapperWidth:t.cursorWrapperWidth,cursorWidth:t.cursorWidth,msPeriode:r,df:t.dateDiffRange})}});this.$watch(function(){return t.donnee},function(e){if(Object(i.isEmpty)(e))return[];t.chartData=[],t.chartDates=[],t.chartOptions={};var a=[],n=0;e.forEach(function(t){if(!isNaN(t.amount)){var e=new Date(t.date);e.setHours(0,0,0,0);var r=o()(e).format("X");a[r]?a[r]+=t.amount:(a[r]=t.amount,n++),t.amount}});for(var r in a)a.hasOwnProperty(r)&&(t.chartData.push(a[r]),t.chartDates.push(r),0);t.chartOptions={curveType:"function"}},{immediate:!0})},methods:{formatDate:function(t){return o()(t).format("DD/MM/YYYY")}}},m=(a(416),a(3)),g=Object(m.a)(d,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"component"},[a("header",{staticClass:"header"},[a("h3",{staticClass:"title"},[t._v("Tendances")]),t._v(" "),a("p",{staticClass:"dates",domProps:{textContent:t._s("du "+t.formatDate(t.minDate)+" au "+t.formatDate(t.maxDate))}})]),t._v(" "),a("div",{staticClass:"TheChart"},[a("ul",{staticClass:"axis -y"},t._l(t.axis.y,function(e,n){return a("li",{key:"y-"+n,staticClass:"data",domProps:{textContent:t._s(e)}})}),0),t._v(" "),a("ul",{staticClass:"axis -x"},t._l(t.axis.x,function(e,n){return a("li",{key:"x-"+n,staticClass:"data",domProps:{textContent:t._s(e)}})}),0),t._v(" "),a("trend",{ref:"Trend",staticClass:"chart",attrs:{data:t.chartData,gradient:["#6fa8dc","#42b983","#2c3e50"],"auto-draw":"",smooth:""}}),t._v(" "),a("div",{ref:"CursorWrapper",staticClass:"cursorWrapper"},[a("div",{ref:"Cursor",staticClass:"cursor",style:{width:t.cursorWidth+"px"}})])],1),t._v(" "),a("div",{staticClass:"ranges"},[a("button",{staticClass:"range -week",on:{click:function(e){e.preventDefault(),t.timeRange=t.SECOND_TO_WEEK}}},[t._v("Semaines")]),t._v(" "),a("button",{staticClass:"range -month",on:{click:function(e){e.preventDefault(),t.timeRange=t.SECOND_TO_MONTH}}},[t._v("Mois")])])])},[],!1,null,"04b1ccd2",null).exports;function D(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var v={name:"PageInfoSingle",components:{UiPicture:n.a,GoogleMap:r.default,Chart:g},computed:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),n.forEach(function(e){D(t,e,a[e])})}return t}({},Object(l.b)({data:"Informations/data",page:"Informations/page"}),{slug:function(){return this.$route.params.slug}}),data:function(){return{minDate:"2018-03-10T10:41:26",maxDate:"2019-03-10T10:41:26"}},watch:{slug:{handler:function(t){this.$store.dispatch("Informations/LOAD",t)},immediate:!0}}},O=(a(417),a(418)),b=a.n(O),_=a(419),y=Object(m.a)(v,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("main",{staticClass:"PageInfoSingle"},[a("section",{attrs:{id:"top"}},[a("header",{staticClass:"header"},[a("UiPicture",{staticClass:"picture",attrs:{src:t.page.image,cover:"cover",full:!0,overlay:!0}}),t._v(" "),a("h1",{staticClass:"title",domProps:{textContent:t._s(t.page.title)}})],1),t._v(" "),a("div",{staticClass:"content",domProps:{innerHTML:t._s(t.page.description)}})]),t._v(" "),a("section",{attrs:{id:"bottom"}},[a("div",{staticClass:"map"},[a("GoogleMap",{attrs:{minDate:t.minDate,maxDate:t.maxDate,donnee:t.data}})],1)]),t._v(" "),a("Chart",{attrs:{minDate:t.minDate,maxDate:t.maxDate,donnee:t.data}}),t._v(" "),a("a",{staticClass:"button",attrs:{href:t.page.contact}},[t._v("Ressources en cas d'infestation")])],1)},[],!1,null,"22be3a0a",null);"function"==typeof b.a&&b()(y),"function"==typeof _.default&&Object(_.default)(y);e.default=y.exports},403:function(t,e,a){},404:function(t,e,a){},405:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"fr":{"statsTitle":"Statistiques","mapTitle":"PrÃ¨s de chez vous"}}'),delete t.options._Ctor}},416:function(t,e,a){"use strict";var n=a(403);a.n(n).a},417:function(t,e,a){"use strict";var n=a(404);a.n(n).a},418:function(t,e){},419:function(t,e,a){"use strict";var n=a(405),r=a.n(n);e.default=r.a}}]);